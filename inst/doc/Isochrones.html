<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jeremy Gelb" />

<meta name="date" content="2021-10-26" />

<title>Calculating isochrones</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Calculating isochrones</h1>
<h4 class="author">Jeremy Gelb</h4>
<h4 class="date">2021-10-26</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>An isochrone is a geometrical representation of the area that can be reached for a starting on a network within a given distance (in time or space units).</p>
<p>There are already several libraries to build isochrones with R (<code>opentripplanner</code>, <code>osrm</code>, <code>rmapzen</code>, etc.), but they are all based on OpenStreetMap data or on external API. We propose here a simple implementation that can be used on a geographical network read as <em>SpatialLinesDataFrame</em>.</p>
<p>We give here a simple example with the Montreal network dataset and calculate several isochrones from the centre of the dataset.</p>
</div>
<div id="calculating-the-isochrones" class="section level1">
<h1>calculating the isochrones</h1>
<p>The first step is to load (or create) a geographical network and to have some starting points.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first load data and packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maptools)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgeos)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spNetwork)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>networkgpkg <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;networks.gpkg&quot;</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">package =</span> <span class="st">&quot;spNetwork&quot;</span>, <span class="at">mustWork =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>mtl_network <span class="ot">&lt;-</span> rgdal<span class="sc">::</span><span class="fu">readOGR</span>(networkgpkg,<span class="at">layer=</span><span class="st">&quot;mtl_network&quot;</span>,<span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># calculating the length of each segment</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>mtl_network<span class="sc">$</span>length <span class="ot">&lt;-</span> <span class="fu">gLength</span>(mtl_network, <span class="at">byid =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting the coordinates in one matrix</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">unlist</span>(sp<span class="sc">::</span><span class="fu">coordinates</span>(mtl_network), <span class="at">recursive =</span> <span class="cn">FALSE</span>))</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>center <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">apply</span>(coords, <span class="dv">2</span>, mean), <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>df_center <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;OID&quot;</span> <span class="ot">=</span> <span class="dv">1</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>sp<span class="sc">::</span><span class="fu">coordinates</span>(df_center) <span class="ot">&lt;-</span> center</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>raster<span class="sc">::</span><span class="fu">crs</span>(df_center) <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">crs</span>(mtl_network)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># then plotting the data</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mtl_network)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df_center, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The second step is to calculate the isochrones with the function <code>calc_isochrones</code>. In this example, we use the length of a segment as the weight but other values could be used. We also consider that all the roads can be used in both directions (see parameter <code>direction</code>)</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>iso_results <span class="ot">&lt;-</span> <span class="fu">calc_isochrones</span>(<span class="at">lines =</span> mtl_network,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">start_points =</span> df_center,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">dists =</span> <span class="fu">c</span>(<span class="dv">500</span>,<span class="dv">1000</span>,<span class="dv">2000</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">weight =</span> <span class="st">&quot;length&quot;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                               )</span></code></pre></div>
<p>The results are reported as lines, which can be mapped.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a factor and changing order for better vizualisation</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>iso_results<span class="sc">$</span>fac_dist <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(iso_results<span class="sc">$</span>distance)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>iso_results <span class="ot">&lt;-</span> iso_results[<span class="fu">order</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>iso_results<span class="sc">$</span>distance),]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mtl_network) <span class="sc">+</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(iso_results) <span class="sc">+</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;fac_dist&quot;</span>,<span class="at">title.col =</span> <span class="st">&quot;distance (m)&quot;</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;500&quot;</span><span class="ot">=</span><span class="st">&quot;#005f73&quot;</span>, <span class="st">&quot;1000&quot;</span><span class="ot">=</span><span class="st">&quot;#ca6702&quot;</span>, <span class="st">&quot;2000&quot;</span><span class="ot">=</span><span class="st">&quot;#9b2226&quot;</span>))<span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(df_center) <span class="sc">+</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="from-lines-to-polygons" class="section level1">
<h1>From lines to polygons</h1>
<p>The lines are the most exact form of an isochrone because they depict exactly what parts of the network can be reached. However, isochrones are represented as polygons most of the time. We propose here some approaches to build some meaningful polygons for isochrones.</p>
<p>The best starting point is probably to calculate for each set of points a concave hull. This is different from the traditional convex hull and is more adapted to the irregular geometry of an isochrone. To do so, we use the library <code>concaveman</code></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(concaveman)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># identifying each isochrone</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>iso_results<span class="sc">$</span>iso_oid <span class="ot">&lt;-</span> <span class="fu">paste</span>(iso_results<span class="sc">$</span>point_id,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                             iso_results<span class="sc">$</span>distance,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># creating the polygons for each isochrone</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>polygons <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(iso_results<span class="sc">$</span>iso_oid), <span class="cf">function</span>(oid){</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># subseting the required lines</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  lines <span class="ot">&lt;-</span> <span class="fu">subset</span>(iso_results, iso_results<span class="sc">$</span>iso_oid <span class="sc">==</span> oid)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extracting the coordinates of the lines</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  coords <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">unlist</span>(sp<span class="sc">::</span><span class="fu">coordinates</span>(lines),</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">recursive =</span> <span class="cn">FALSE</span>))</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  poly_coords <span class="ot">&lt;-</span> <span class="fu">concaveman</span>(<span class="at">points =</span> coords, <span class="at">concavity =</span> <span class="dv">3</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  poly <span class="ot">&lt;-</span> sp<span class="sc">::</span><span class="fu">Polygons</span>(<span class="fu">list</span>(sp<span class="sc">::</span><span class="fu">Polygon</span>(poly_coords)), <span class="at">ID =</span> oid)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(poly)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a SpatialPolygonsDataFrame</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">iso_oid =</span> <span class="fu">unique</span>(iso_results<span class="sc">$</span>iso_oid),</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">distance =</span> <span class="fu">unique</span>(iso_results<span class="sc">$</span>distance)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>iso_sp <span class="ot">&lt;-</span> sp<span class="sc">::</span><span class="fu">SpatialPolygonsDataFrame</span>(sp<span class="sc">::</span><span class="fu">SpatialPolygons</span>(polygons),</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>                                       df, <span class="at">match.ID =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>raster<span class="sc">::</span><span class="fu">crs</span>(iso_sp) <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">crs</span>(mtl_network)</span></code></pre></div>
<p>We can now map the obtained polygons.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a factor and changing order for better vizualisation</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>iso_sp<span class="sc">$</span>fac_dist <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(iso_sp<span class="sc">$</span>distance)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>iso_sp <span class="ot">&lt;-</span> iso_sp[<span class="fu">order</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>iso_sp<span class="sc">$</span>distance),]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(iso_results) <span class="sc">+</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(iso_sp) <span class="sc">+</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;fac_dist&quot;</span>,<span class="at">title.col =</span> <span class="st">&quot;distance (m)&quot;</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;500&quot;</span><span class="ot">=</span><span class="st">&quot;#005f73&quot;</span>, <span class="st">&quot;1000&quot;</span><span class="ot">=</span><span class="st">&quot;#ca6702&quot;</span>, <span class="st">&quot;2000&quot;</span><span class="ot">=</span><span class="st">&quot;#9b2226&quot;</span>),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">border.col =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(df_center) <span class="sc">+</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAllBMVEUAAAAAADIAADoAAGYAOjoAOpAAZrYsAAAsABwsRWs6AAA6ADo6AGY6OpA6kNs/VUlOV31QZVldFBdmAABmADpmAGZmn6tmtv9uaH2LaH2Len2QOgCQOjqQOmaQkGaQ27aQ2/+eRgq2ZgC2/7a2///DaEbDaFnDen3HbzPbkDrb///fpGf/tmb/25D/29v//7b//9v///8b9NN5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2dC5vjRlqFhwQCBEhv1wIBlku0ZJFnmZDU//9ztC1V1TnnO6Wb1ZfNWs8zbVmSpaq3zncryZ5P+bEsLp/euwEffXkAWlkegFaWB6CV5QFoZXkAWlkegFaWB6CVZQL06bGYBQG92wB94OUBaGV5AFpZHoBWlgegleXPDlDaefyvE9A4JnxTFtmxafm1AXrBkOZ/bWnvUrpi2rP8igDN/b/xYEDz9nnfvrP+SgAhilRFBJhSeUl/XoDmjidG8YJh1hIb17Rz3xX+dAGxsyFCsEPJTb56x/LhALVhXzxoBJ2oiEhVtP1PHdCtP0kcrPSJzIWccRNTYaPo1snH5b0B1bAS+umWBBaVkAVppomIT1mO3tXA9wQEjSc7kCSG3tY+p+JSVERoWUVqqe7YTei9AJXWtw7Da+L+JmWAIhJCSWRTTld37E0V3wOQ6w73tjkZo5JyYFK4gquISONZ2hXo3xiQ9kd7nkQ8JlovpIHMTZjDjj0tfjNASAYw8OhT2CbtxOOsa5LQJrCOEHoTQKYfGnAKL+l0R2yx3EqslvApTop2tP3VAck4mqGmvWIs3rvEUDef2uiNhbg/VXxFQL2+BRrNjTovxAjakQZRcPmB3HySdwekXeuLCNYS2cHER3Oi+hLxyQaTQcJR7wjItLWDCLtPEax6GCMi4hPw9QK+OLA9Ux4nAsKUJfDhbbXnff/TTqWdQwEFIFZE0aW/NSBsUQjBscGAg9yKIdhFFPEZnnANPskbAjIMUgeQj7/NU5MTTu7gcVZDIrJyTA80bn8TQH0GPT6kek4bJS3Uk0h6EOOShi1Yt0p8ZUBdALdm9Pm0VqoN0fSWc8EtgFEyUDaKj/HqO1JtHAAU+68xfQmQdyAhggWPK1MWbEfRqNlaw/btXno3ICORbnjtEQpgeMQXIliLXuydzaChg9btO+L8TkChh6YNq4DC0Yn7Sy442FmCT/X5cLu0va8ECK8RgFCJsMrHpIjw+Z4gE4pohM/5a5KD1oufD0iuHYFQQb0CiKOQOugQiORzpLaegKQtepKzAZlrh/C6EuKlrRjxAYUTIkWwWOMv8HEFzvTmVED+6nNDe1lHf0Ee8iFb1O6NYHQhdXflzYmAFjrqYtDqEj10xylL8IEI1kPgLuQKnPE8QIudbhPiYC5riHwR3wygRxtFxGVo75KiVD7jOYBiM7UNxRGBga8Q8h7aWxB1jSJY+9sVkYlhAPMMQHJ2391iIeBgF0WkHtoYgDUzZZHon7skqhELnGn1FAVxE3s9bvKxniS0Gg+JKaJek2o38ecMyV0ppgh14xmAsrtw6Gu8Ndf/mB4SUkTGwl2LEQy3xQKIr0i+PZ0EKC+G7RqmqyPy7iO2ujaZ+kYA+FTqfOrHjR0pGCPLcXsitAJoxcCqZutg9mKQ3cQ30vveiZ2P80Lh/Boro6M6SUEbZ3eac0BJ60dD2W88tFUEnL8eULySCAOO4U8ER3USoDC70TN1GeHUOVZMR7stYOznuL+2PeqWuN6bljMAlVAQHqXo1Thti/GcakMStm04KwyCg2uQjCqNJ4uWewIgaidxIFnFdqYgAtPGBQ/NXXQGkmC7fM6YI5lzWbkfEClUxjtJa/se2iY3dLQVHIso7qYMQa6hJIVvOfp+QNij5Byldsd76GiEMUGMFgDeLe5Osl08nw5fcRV89N2AiIAaEQOSoTTCd822pxOw4VTNK3nPHfc4EV/XTgUkCgq948I+SCYYIcmx46HBGcvYVD7Gc5vw4ASaNs5LLwAaZQERqYGRzUCBHoWBu3g8vTy7IrKemw70OREgOhdQmhWgrS07USDGVemtQXIKwce7FDFGSR2sJNjpgBhXt1UbWwFV7ydtaG1rzUixNcgj4eBWIXhEPPjcnqBTOQWenj5ez30foHCh0ktTwEK+LfkAfrQNqYtg1Jl6NTqaxBJ0WseQW251Of07DRBr2ZRnYjDSmhCNOxEsikgdDV5CnY+RHJ9eLnUmIO1UrzzjMdS0ozVNajCXE2q/WURJG9GPYNrydtVxE6EuIOXD7zqDlEZs58it4b6o3OENgI01fvGBTkTeXclxCV5PApT0guOooqggEu02ef4oUUkVkniX8SDoEPGsyR4dCNXR25YJbVJQdDoWC3lUIMV+JyULgFfKHzchgjXGUgTr9qAl43cA6sBwF639TNTO+qIjT56lpxD00OLLVJD1r7RyWUS396cB8hoSv9gcEIlIChTBZy+iHAiHfhB42/bZLszDdh4gi4jtnoTEvTNe1xVZcK5EhkQZTITWSe9Do+Ob44DitToDRHkLKorFL1ZS9rO14IE2bYxHwE6rceueobWnAuoEd2mo2hUfRaMd8qVxZKy+9giJdajBuo2WXHpLGFsA5IzKjSk3tHWQHdLUiSI6wRau0T7vdMLJhB4XGu3ezBc+Cmici9IFRGZg2F3WMIT+I2jGiojsKzob2blgYLGpMiZHASV7buqSaHdkNuNsDDy6zQFF0wnjHL2OVW1a5WON+C5Azqnq5dS9Uu7GuOpZ0AATfVT6yLU6sZKGhRHtLEqovD8KaBWRGfaOr068zTmXUYQmANuu2PzLZbgMw7D46L9pant3GJCTs6GBBxHT6KuTyMh4/AYz3LcuPK5EyjKUPxsAdXz1MUD1cXHocLic9pJtDjusiZx1KSAiZ8H5qpPCpSJ6WbvxuWwBJJrd6oQWAG0VEfRe8gxqWqpH2rSRaKJFzYBAOgOLaLhF3U2IcG1jsdEJ86EDaxE/yIMK0XKC0ndXf3KycG3FhCJPqzdno4hu27Y9CBebfHt3JyDswKKIknwgNFnduvXIIBwiMaDDQULXvzmccRERN3yd0HqpUTuwO22kBKY8URw/0qR2vfAUmdpyRTFUPiAi4TPuEREI+CAgjjAOA23qpY3gCqeukDXSaWfZqDFdZu/MSgIPTWO5VURw3EFAmYe/2wJICkVEEOVynjpc8jmxs2kQQ2QiEYGBsYi2zOwFQukMQB0PLS1IAKOTNhZnOyFqp58Pm9iQZCKHWUQD7QIPjZ3fhOgUQOShfU7ELo9nJ4rHvdrI0LpexFSWuq+mOeiBq12xsKqgNiVABlDCATwOCO3VIor7YCVN6sFuNXdyUS4YsUhEA/y7gIju4YMtPQioETJhOzptDd+zcyk9l64O2H1N+wwH3XanfkIAuQcQZXsqIut02vBkIDGQIBywGRfCImbG6O4CRGnXXQryiIQP+PTZLKvzrZhAAWVbcEBqce1zpxmYWMBRQFDTx7J7xEhuEY0tFw6dJwujnYNFdIEFRXSngMZNxcYKoKSn7JUSuPOqupbXBAshTXE0VyAU3eGz0+fvB7Sh2Fh5gCqWTgDN5Ryz6WVNeFlMiALju0jNpo2F5N0uqPTsMCCpxyWIhey5Hpem5EcHnA0ItcHbjIguVkSHCUmr71CQmewusEIGBMdl7kbtHwkGtYGcxDdV2UURDQfdtDb5HkB2ykJgRT4DKiYqiXy1TmgEjlZEQyG/gVBs4JmAeqF8wVdfAVUqQ5AMMEFtDOir9G8Q0VA8+qbJ6Fg/ngQomdO3DLHjqxNMIA/BqgABpkNEBjc7tc3hb9qxbTb6dQDFgoLZtKknCnFTiC/pYHTDTVukE0HFb0lEk+WWXfvn63Xn3YBUInS7XWc6bjniTCdUn2QlHgXnSsOgH5gsESS00VEvOM3DgLr3fTqJdX2fuddYW/B0O6JQcMVA10W0kVAb1fPCvOdO88p8xPxw7QWsi0TURr5BE6Hox1y1X06xixBUBYzoHkBWRFCeUZhrt7RyMQYWyex1QRfRsuCNzpxdOHlqItqaDcF8/fZJ1wVAer8phRcNc+V9bgbCyU2xDrUoV2/5FGigo3cSwgFtrb4TkIrIlPOJ0Y0JZ5lBRHXilEqJEMFAKiEF0rnXGdF2QiZ/uxeQrzHCdrokzSGyiEIAb76EWIj1sYfGAdhHyMyC3g+oc1dDI1tz3uU+hlRilBNFt1wP0IBX2eRMGxDREQ2NWwgtAbI3LXs1Bn0DIxMLCD/DBW2u7hQ7K29RRNf2PGXYUDV52VO3kpfY8gDDRkDuVobNjuZLNndT1NDkwLkgdNNYVGvL8/Pz01PWj5ZQsOUZqtZKyYSOA+rcCrQ1BoWHTM6HEz7NjtXkbgZTsTw935an6+vTcyMkHxu2zi9KPLkTkBAwztoZ3BznOY/BpAjRDWJylcsTopleX9YywCVvv5UQVEmnAOrdTx4DGEaZq+XoyqUmi2QsFU2DUtE8N1T5MtBHB7S25V8pDj3YFufXfVBPRLxNjsqgmxCa0f6GuWuzkylIJpMiET0VJxTiXz3V6sOubGHl6OOA8A69cNEpMwU0WO1gmlj+Xq9TRFJ8Tf0DIpo28JMOmEfcjGzt2QX5WdR0CiAnIlZN+KmTuaAnEbUxLyOem3IqobbOhMpKFs/TXNHVt5ubdQKI5x3GO8N8vXnoH4/yOdGtjXmo48pGAR6IlQOIUE3qiTKaFUvxlgv5m1HUdpoVTScACqmD+cFsrdhquSoRbBrt26NkuXUeQUAAm6E84dbqhDD+VUpZqyHHBwxsEtSdgGyY4lU0uJRaPd8T0fV5vLnXSKjxCCJqYmpOSMPZZU6nF0Qkip//3gEoJzwpnL6bE80VRwjzJKKcc0WhInpSPZHVTYBmOw3zsZcaVTqIOAifEMWyDWEa1xFhoZSrcQ3SiVtHbgSEBWiFmWDa+FyeOeLoWNJMHTThw2lQ7c4dgPKoP3AghlxFg+upPPwSLKECQjBACNY5ha41hzxBzWfH/8ksiihJZ+DlOCCT45gUEW4o1kvWFFEtYZgBgR0BKxfO6KBmY+rcgFAyIkoY5bn9C4TWAMUvZ2rKQ/6uNSyDA6La6xbGqu2oXIyIKrQ5jonnpxoPM7f4QzDRObSvJR0FRLDr2DCi1iQckgsW7iKi/BQcUEufVUTgy+cwpjexGy187EtF5L4Ruu6HNgLiaE8lWd0hDeAvd0kBn6N5gYMmEVGi+PT0rMVG+TsBql4ycetKw1HvbTX1bWwzIC5KMaFweUCquaJDNElI4xUnRdETFURZJk8uoNWaKdZIwhKPNUB1EwcBiRybXGAoKEWsB2AqRHZ28xUxHWQHDR5axZb1vgacvKa26BJG2hjtbHHidV1B5NNAQBrxEzdszHLnprroW0eCeamDRrfDYst63jlYFkAazcN/C61WMOe2xwCF58xAOBzxdWSySxFL7M/BvChStZ1u0izcch1q2affKKoiovilTb39pMhxQOxx6ELSCtqa4RmVeGs0EAop9DMn1m0FZs1knmm4VMVzHKlfiZU2gvX14tgmQDyHAiSCIeNqDj0o7nQoNgY9NyyEVl2B+NhuqU2vmUSNAiIfrc7htnoPIM68JC6UK8l8bLJxvnihbDIgF9doKm1+ye6Edc4fRF1am2aBY4rSXqtPOAZI6r8kppTiUJSjqR/VDAogCe9StdvEurwttzaqiHCF424L+fjTRaN9vRMQqzKo1Fi+3AZtHvrmLMSvRO00apo21lsbg3qi4XLhuKsqN69wx/wYIAztuMZyEYojfh1BPfTtT448iIZPrEugv6iIiisamBCHfNNKRHhYQex5ZvQcSIOHvv7VG8U4gT+HMZMj3lY+ffpkE+un+e7YRUVU7HeqVzV9rm2LYoJAdhgQa6SMjOeDjQqZECbAGdyMuOinK58rIZs2PpVJMzawNu0KwykpUYoOAssAK6GtPsg/qjDanTLjocZVAPGEGNnZBKiXNspDHjJjAP/ndFA+olMPlLyNrQNqqaIkXywghw++70weeupIuLfceBRAnbQxw0nBvuq0a4kbUUDUXPZAhxWEuTR5ObFngy+35qOAZlMIE2KAqPDppI15EETwDwZUxg1yyCSv08txQHBquFQVqTSgyi0DGXQTw5wJhQmxBuHJBTacdtUqo8mzeU2dMUs0wOb1GCAOWWRPkAIhsfKOJ9gv3Ks8997aWQdaWaVJMxHRALOKMSUKvplyooMKCv/BEAfOXl42jkkCPZThc64IZNDOutBaIkS46RESyv21/kGfPFJcS95LbwCUl0JYnBnHt/i8Ux3hspLFbsyNIAOtJkIoIvLW8ht+IScCIOgwOl56I6AulIS5Rd3SAOFU0MArbVYxuJunBWjP7f4qujcI+Tlpx6taqIXxQW/jprcA0seEZBiUHhyJcT7MfWSwJVPaBweEcoq2CyIqxYYoidBIs/vl2HZAclqOYBIf2hQCeWj2q9lo54bhyciKN1UFNdttIfKSQwBLqh6dQCu77wLUfoesXVQvEOImjrKKKIcajDA4r102ke1WMjRrFgyfk58UIkq6H9DIA5O69+1r+yAT4sJ7CmNagz2xLZHbIUL0O17g3GbjhfHEAUzU1KIiavIdgILdhqLehPz4AxUgIqpXrQN6ig6o3PsJLq2JaIg3f8Q902iSAz0GKOPZOILZGswQMgNeC3ozCWSeD+KD3ReKioiG1t5YvLeV6EDTHYA0mWjn7ZWw8wXb2AZE2aRAwbwgRYyZ0CB8iohw7l6HDvfo3OJRE8tync7ohOpwHGlWUW/+5GBeaExxOgRF1FJF5jNZM/3nehzyhYoO/FFAkj9IlDAlrBAKxjA9whCcC4cxeUURGdPFc9Mz98VV8ogmdqLtR9eOAMoqoLQQIwTRws+wTk7IeCDi4R+qao/iRUQvBauYOo4gNjcptqOAottnCpqYISA2A55gF4lYTySVPU+aielWQL56hDGELYWezYS2AgIEhY8iEl6gIHWjtWeZe21SoJgj1jgPM9yDXkGfuWdvjM0tZlZ6dRyQERAbWafiz8EMYFbRzAI5ERlEGZMrdtXDrV5NPD8miOjL/6D/UK7uAJRYQCKUmBPN7/jbFWXAy8R0rCfE3sIdoWeI8zARx1MfpRyjMcWGYZjhpt8BiAxWhGIjWGqAFNH8mo0DDg7IFPRToOfvCeN15m9t8N1mShKx9fSfWR8GNNNRDy1pRrSz8C3KC8ae7OqJTmLNFpirh5a7AhOg6aGXJP9Hh6ZuJCIbxjYDwkGIQulEsGsj3YNULfZkckBWRI7Vc845VhoD/DJVqsoIEx+ooRiejwFqWp1w9CcRo4gy/SQeGkMBZIqwvgN6vjUILYuTKyno5YG85nFQ9EjroIJIiujhGjYrInJDRTvkTo0DZgdUWc1waOZfzlgiGxT05QEzCmk8kKywY4DgTGrHCxGspad6B6K+KxIKZgW3pAuaTJUd8KAIcF2ngn5+wIytinpAjT8NEAdRb2ctGzJT09O7XKiEih7MK8t/OhKf4ecIMODtzuqsI5g42HcBSnouTheJkMoqt+fCOG1sNzfCzFmTTkyZ29kusmuY5qWprphddQm5MqdVtrgwthtQ50kORyipdJt5AKL8JMZUVp5mNkyVH9sMLq2Ynk5hoYh46FraaKux3aWGOmhb8lhgVNg3QtmWopVNe/gcjYkyIJJVya/UDVZfHYoA+GbdnU5aM4YCpYtr1KXZCky8lgjV3E3WKRIGEckAoQIoNHXBE9H4yt3DHfNBHMJYwDAaPYubETXbqsn009NzdDfhR+JURNMp1Dc1Ps2/wFBS2hjDmrGxzVOunceROFpRfuH4UDiDkj4X3aANScLTttBP6ckeABTzDwbkwtmoqeLmuxorIcyUPB1AYfa+oJGSoR3AnvjSineeJ4DD4AkPaUV4UiWsHTKxcooQwjgHJevyfHQCDfNGdxs/poIDxzESUY0A8YuAXUS6dgQQnaLrk+nS/nvZlVCwM+mqgxVToHAKFVDkoWNn7/MdBRTTzjjvitlZHxAZhpYJIapr2S5PY7WzdQQUhzRmQQRvv4llPi1P1FlEwRyVEOpARYRGhbDqlmHQD5K/VkDd2BKqpHmObzegkBaTGw5+sA5cBxH9pjvp6YJlVuVwIRFRgIvZ0oV+rWtWiMl56C0XZcdMLCrFBMlylRSOiYDIQzuvNBAAwRc/2HbkmjG3doTBlLk/BLYTkLIPg2Hote1WRO6+KGbD4FJCjIu5ER0xT9mnKp7SnsJKw5YpV5HQOqAEC0PgIA8HJLexQ0iSIrSgYEVAJuaIRXOX+ZurqCCiFCbKisDsd+vWAREU6DJeKyUZDhgsS0geoYPVkNSwRGaVaG7E2tMsKLSy9UdG9F5AAmq+hHps5eIQmZrswmnj4pqKp0W8YSlLhAF1R1Sj2AWo8+OEjZC3qyTHLhCynojyH6nF4vQQsjW/p4GN0z2SAmgYOw6IrkfhwPCI4QwB2bSxeFz01ZACRQ80FDzZaBfcgoLRyM+p4mFAIftRUIGQ7CBC6KE5KyapFDftyNyevotPEdAIUmTXCWk88gxAnaKslz7HnIgJCZsQ3JZSoBlehv8LpLnFZlTRG+DR1JujgCTii/ku8RmNmSkhnOSgyC1SCS7pMv2uMjUpWBNCiCLiiYlDCgqPk8ScaxlQ8E0CCGUjN/RFKhK9bo1UVYSUkFUSD8eG7gNkbCxQCFGig2hcIlT5zP/lM8jF2FlBg4+eTE0wrYw5mYgo8edeC1Anbw4N9YQKhOmC8jt6oeSqLavyCK4ltDBugc9T2vg6gHqFRRdR7vMZ4R4Iimj+2iU93B5+dILfylG1yaEOKN46nQ6ooV8FxCqLCTVdjova+c+tSUJE26VhqXV/dIckPObWi/2AritJFwIUItsCIkNoYPnMuymAzc3B5wvna5qwZFoS8xLT5lS7uxlQbsfHrgZaGwhh3XxhAnrk5Kzr1VvAVg+yWEOEyxoPVN9zKr1xylXktNz79UOgrfj1U3vyWTQFA90obmdq1p14hzTMTZw5yzsOaN8v6y8cVBrWZqi7RU3tOg03ZWW4pb0RNz2fRXcYy2uEDgBaR7SJUEldyk3DpdNiRhOMKLgkCOm2HJKo526XNy99CNAqoo2EJklM+c7yKUkU3B0G0VQSbCnm0fWsxoHeCWgN0TZCYyG0/p/u0iQz5cPBJY10iI8eELwSObB6xDqgz5+++mGJ0Je/+Lc//M2/1BP+z79yh1Y6jB3Pwybf301cdIWOsFoCjbW4yIesAvr5t98vS+jL1z/CBZFVbM5iv19Kw21H4llpfk4uiTOdoDiNaeKHJHVaBfTT3y3q5wYIBj4A2kxoQ/Jd+iDzuPUyQVephnRQj16GqMXYtgLop28/ffrm9vfTdzn/8rvrO5TXp6/+8+sfrxD/8Ncvh/zm+vdvzfW3dX0TIh+22eOEcNZPikYCOJ8vRQktKuhmZp+//vGX331DJvfzb797+XcDdBPaT9/+5g4FdZpvTydJXZza6L369sQsIHjpRUD/98dpRc3tZl2fJ0B//+N8uAI6mZCLRc5Zi79ZLoEWHmvYBOgFxYv9fPXDDQgsn//qhdwLmusxv5+Mbzq80/gty9pEkj3QPhLJztwHMdgbHdi0ts3EXiL9y8oSoJtD+vrHJrJtHTaNXZytJRJkWG6SkC0vOmDcK2lBXd8C6MsVxJevvIl9aVRe/FMIehuxYLMWJ/xHIxZ1zS6clZcuoBQAUkG/DOgqoG+/+uHqpK//yvLzb78pTvrG6uU1pk2bwUDLeoiClUifNFa52729s6awex6NDYCuDuar/3rp+kKYn7zU9VA84Cgh77iSRpipB4nezUdQTbIYxOiI4KzLvbHDtdiGZQ+a2tHOUJsZQoln1YzqHQzX7fD58jc46/z6gI4QciKKXlT6NG/QPtobd/6saVQtlT7sAXTLq2eLekVCbiJw2hE2rx25AIggTv/aPY37ZhR3LLvpzG1mbwN7dKs4V51CW0gT0UPXKJfKJ1sXXhfQMUIsos6PgnREknAFEsGOA2u+fd6ex7cFdJwQpjImSTSyqpqSXmtNymTGaQia52E+rw7obkLBlMykOycBMaHuRkBwQIVPvj0Y8IaAjvqh7j0MF/KZWbe8Uj6gLnU9WwD9MyxvTejWcLgJJiKIFsMR3cwPWb+f6JC9P7h9FqBjCePcLdeVmAIRMzI4SLHNsQnJ+8a/BaDjhCoiDkU2BRL3TZOL4qRwZSbfbfseQC+V2Utp+lJ8fZ/nv69HqJYLCUefYk+wOXXW7Vz8iYBu6f8R3QHol3+/zf7843UWcfr72oTmR1HkZqr12+3FOGsG3CR2MqCJyE//8McXUtPf7YCOEML8VjYrgSgWAYNeG45Iq3z2APryl99++iZ/+ebF1r6f/u4AtJ9QwvqcCIU3Znepq6pmotduG08CdJ3D//z9mwFCc6IgzriSIgOxUBpYWBmvfxagl+XzdwdN7JCE3JsU9gQBaRKuwQ+rkTMBXVXz+ftjTvoAIXLOo4w5KWr0R/XDWUsiVvnsDfPf5UNh/gihVMuNuoH62npP6/ZYZVXNDGbnTwB097KfkDrgENnlbyfGN6NTcxs/FKB9hOIXQtQdty3kjuXY1MAgq0bwKKDXWPYB4tcQwch2wo+voK9OIQMaNwpoCdD/wvIehJKuxayRFKMBv2lMwlnhtMVHvzmg7YTUP5sIJpIyt4xKMcdHc/36wQBtJZS08z6CLfiousk4ZsyETgT08z/9yGH+SLDfSGix85wTBVuk88Q5azzS/Xc+hwFdb8dTNX8kXdxISGYoRjGgznRsBAQ/ssJCKmdba+wOQL/8x3+/KAhLjQMFx0ZAfqai63AEAZOoaxVZe4RxvbG7TQyL1f0l61ZCehdDQ3TAkUwQg2oluRRxU1vfBdD6dxnYDaOj7SZFLohJ6gx8Njd1N6ATTEwJmX5JRCdz4p5arpEP7tzV0t2ATnDSkVDsKAexfhEmNhdEpe92N/QdwrwhNMZ+6exzL2dWckyMz3uknW+fKJZFCJmYxBB6PdeAF/37cTr5zYtVXJhQ7LImMETIhDOTGRxzO7QsAMLWH7/AwqKEJOBUL2xcdahDLOGNueDi8p6AQrTnjpYQH43P1yHxfTqh5e8KKOZDnPL2xGJtLvj5IzErLjsAzcxZXlcAAAFbSURBVM8CnxTF4jVCR1Mwstb1dgCypTPd1bC67AD0+fo0+fcn5UHmGqajWCrYI8graYNPWXaaGN8XO55J24sUKBYG1RhuP6zf1SJZ9gF6yRRPqcU6Vwk9JQcEvqlTy67fxNm/7AL0YlLnFKu9y4zqcyg6xbsc+ok7m+KWPYCmbxeea2LZFx2dOQ5ToI4nRiy37AA0+eNznXS4kC3Wq0X1PndSxHLLDkC//3T7hu+pYT5eCQ2KpHPCdY4s75somkvZGP5edPK7Fqu4OCj1zfs1K38YQNkCOjbFde7yUQB1ftb7PVs0LR8GUPnJv/QhPE9bPhqg65I/DJ38kQDVn2LN+Kty7758IEDTT0e+cxvC8pEA5Q/I52MByq9YMhxdPhagD7g8AK0sD0ArywPQyvIAtLIQoMdiFgD0WLrLA9DK8gC0sjwArSwPQCvLA9DK8gC0sjwArSwPQCvL/wO/mzWDZwX+EAAAAABJRU5ErkJggg==" /><!-- --></p>
<p>This is more similar to classical isochrone maps. Another possible enhancement would be to simplify and smooth the limits of the polygons. To do so, we will use the functions <code>gSimplify</code> from <strong>rgeos</strong> and <code>smooth</code> from <code>smoothr</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smoothr)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>simple_polygons <span class="ot">&lt;-</span> <span class="fu">gSimplify</span>(iso_sp, <span class="at">tol =</span> <span class="dv">50</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>smoothed_polygons <span class="ot">&lt;-</span> <span class="fu">smooth</span>(simple_polygons, <span class="at">method =</span> <span class="st">&quot;chaikin&quot;</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">refinements =</span> <span class="dv">5</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>smooth_iso <span class="ot">&lt;-</span> sp<span class="sc">::</span><span class="fu">SpatialPolygonsDataFrame</span>(smoothed_polygons,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                                           iso_sp<span class="sc">@</span>data,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">match.ID =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(iso_results) <span class="sc">+</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(smooth_iso) <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;fac_dist&quot;</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">title.col =</span> <span class="st">&quot;distance (m)&quot;</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;500&quot;</span><span class="ot">=</span><span class="st">&quot;#005f73&quot;</span>, <span class="st">&quot;1000&quot;</span><span class="ot">=</span><span class="st">&quot;#ca6702&quot;</span>, <span class="st">&quot;2000&quot;</span><span class="ot">=</span><span class="st">&quot;#9b2226&quot;</span>),</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">border.col =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(df_center) <span class="sc">+</span> </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The shapes are cleaner for mapping but the results are not exact anymore.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
